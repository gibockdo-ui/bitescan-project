<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MUSIMUSI í”„ë¡œí† íƒ€ì…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto+Sans+KR', sans-serif;
        }
        .step { display: none; }
        .step.active { display: block; }
        .symptom-btn.selected {
            background-color: #eef0ff;
            border-color: #4154FF;
            color: #4154FF;
        }
        .accordion-content { display: none; }
        .accordion-header.active + .accordion-content { display: block; }
        .spinner { animation: spin 1s linear infinite; }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center min-h-screen p-4">
    <div class="w-full max-w-md bg-white rounded-2xl shadow-lg overflow-hidden">
        <!-- Header -->
        <div class="header bg-[#4154FF] text-white p-5 text-center">
            <h1 class="text-2xl font-bold">MUSIMUSI</h1>
        </div>
        
        <div class="content p-6 md:p-8">

            <!-- Step 1: Home -->
            <div id="step1" class="step active">
                <h2 class="text-xl font-bold text-slate-800 mb-3">ì—¬í–‰ ì¤‘ ë²Œë ˆì— ë¬¼ë¦¬ì…¨ë‚˜ìš”?</h2>
                <p class="text-slate-600 mb-6">ì‚¬ì§„ í•œ ì¥ìœ¼ë¡œ ì§€ê¸ˆ ë°”ë¡œ í™•ì¸í•˜ê³  ëŒ€ì²˜í•˜ì„¸ìš”. AI ë¶„ì„, ì‘ê¸‰ì²˜ì¹˜, ì•½êµ­ ê°€ì´ë“œë¶€í„° í˜¸í…” ë£¸ ë³€ê²½ ìš”ì²­ê¹Œì§€ ë„ì™€ë“œë¦½ë‹ˆë‹¤.</p>
                <button class="w-full bg-[#4154FF] text-white font-bold py-3 px-4 rounded-lg transition-all hover:brightness-95" onclick="showStep(2)">ì§€ê¸ˆ ë°”ë¡œ ë¶„ì„ ì‹œì‘í•˜ê¸°</button>
            </div>

            <!-- Step 2: Upload (Updated) -->
            <div id="step2" class="step">
                <h2 class="text-xl font-bold text-slate-800 mb-3">Step 1. ì‚¬ì§„ ì—…ë¡œë“œ</h2>
                <p class="text-slate-600 mb-6">ìƒì²˜ ë¶€ìœ„ë‚˜ ë°œê²¬í•œ ë²Œë ˆ ì‚¬ì§„ì„ ì˜¬ë ¤ì£¼ì„¸ìš”.</p>
                
                <input type="file" id="imageUpload" accept="image/*" capture="environment" class="hidden">
                <label for="imageUpload" class="w-full text-center block bg-[#4154FF] text-white font-bold py-3 px-4 rounded-lg transition-all hover:brightness-95 cursor-pointer">
                    ì¹´ë©”ë¼ ì´¬ì˜ / ì•¨ë²”ì—ì„œ ì„ íƒ
                </label>

                <div class="mt-4 border border-dashed border-slate-300 rounded-lg p-4 min-h-[200px] flex justify-center items-center">
                    <img id="imagePreview" class="hidden max-w-full max-h-48 rounded-md" src="#" alt="Image preview" />
                    <span id="previewText" class="text-slate-400">ì‚¬ì§„ì„ ë“±ë¡í•´ì£¼ì„¸ìš”.</span>
                </div>
                
                <button id="nextToSymptomsBtn" class="w-full bg-slate-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-600 transition-colors mt-4 hidden" onclick="showStep(3)">ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
            </div>

            <!-- Step 3: Symptoms -->
            <div id="step3" class="step">
                <h2 class="text-xl font-bold text-slate-800 mb-3">Step 2. ì¦ìƒ ì„ íƒ</h2>
                <p class="text-slate-600 mb-6">í˜„ì¬ ëŠë¼ëŠ” ì¦ìƒì„ ëª¨ë‘ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
                <div class="grid grid-cols-2 gap-3 mb-6">
                    <div class="symptom-btn border border-slate-300 rounded-lg p-3 text-center cursor-pointer" onclick="toggleSymptom(this)">ê°€ë ¤ì›€</div>
                    <div class="symptom-btn border border-slate-300 rounded-lg p-3 text-center cursor-pointer" onclick="toggleSymptom(this)">í†µì¦</div>
                    <div class="symptom-btn border border-slate-300 rounded-lg p-3 text-center cursor-pointer" onclick="toggleSymptom(this)">ë¶“ê¸°</div>
                    <div class="symptom-btn border border-slate-300 rounded-lg p-3 text-center cursor-pointer" onclick="toggleSymptom(this)">ë¬¼ì§‘</div>
                    <div class="symptom-btn border border-slate-300 rounded-lg p-3 text-center cursor-pointer" onclick="toggleSymptom(this)">ì—´ê°</div>
                    <div class="symptom-btn border border-slate-300 rounded-lg p-3 text-center cursor-pointer" onclick="toggleSymptom(this)">ì—†ìŒ</div>
                </div>
                <button class="w-full bg-[#4154FF] text-white font-bold py-3 px-4 rounded-lg transition-all hover:brightness-95" onclick="startAnalysis()">ë¶„ì„ ê²°ê³¼ ë³´ê¸°</button>
            </div>
            
            <!-- Step 4: Loading -->
            <div id="step4" class="step">
                <div class="text-center py-10">
                    <div class="spinner w-12 h-12 border-4 border-slate-200 border-t-[#4154FF] rounded-full mx-auto mb-4"></div>
                    <p class="text-slate-600">AIê°€ ìƒì²˜ì™€ ì¦ìƒì„<br>ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                </div>
            </div>

            <!-- Step 5: Results -->
            <div id="step5" class="step">
                <h2 class="text-xl font-bold text-slate-800 mb-4">AI ì¢…í•© ë¶„ì„ ê²°ê³¼</h2>
                <div id="result-summary" class="mb-4"></div>
                <div class="space-y-3">
                    <!-- Accordion Items -->
                     <div class="accordion-item border border-slate-200 rounded-lg">
                        <div class="accordion-header p-4 cursor-pointer font-semibold flex justify-between items-center" onclick="toggleAccordion(this)">
                            <span>ì‘ê¸‰ì²˜ì¹˜ ê°€ì´ë“œ</span><span class="transform transition-transform duration-300">â–¼</span>
                        </div>
                        <div class="accordion-content p-4 border-t border-slate-200 text-slate-600">
                            <p>1. íë¥´ëŠ” ê¹¨ë—í•œ ë¬¼ê³¼ ë¹„ëˆ„ë¡œ ìƒì²˜ ë¶€ìœ„ë¥¼ ì”»ì–´ì£¼ì„¸ìš”.</p>
                            <p>2. ê¹¨ë—í•œ ìˆ˜ê±´ìœ¼ë¡œ ê°ì‹¼ ì–¼ìŒìœ¼ë¡œ 10ë¶„ê°„ ëƒ‰ì°œì§ˆì„ í•˜ì„¸ìš”.</p>
                            <p>3. ê°€ë µë”ë¼ë„ ì ˆëŒ€ ê¸ì§€ ë§ˆì„¸ìš”. 2ì°¨ ê°ì—¼ì˜ ì›ì¸ì´ ë©ë‹ˆë‹¤.</p>
                        </div>
                    </div>
                    <div class="accordion-item border border-slate-200 rounded-lg">
                        <div class="accordion-header p-4 cursor-pointer font-semibold flex justify-between items-center" onclick="toggleAccordion(this)">
                            <span>í˜¸í…” ëŒ€ì²˜ ê°€ì´ë“œ</span><span class="transform transition-transform duration-300">â–¼</span>
                        </div>
                        <div class="accordion-content p-4 border-t border-slate-200 text-slate-600">
                            <h4 class="font-bold mb-2">ìƒí™© ì„¤ëª… ë° ë°©ì—­ ìš”ì²­</h4>
                            <pre id="script1" class="bg-slate-100 p-3 rounded-md text-sm whitespace-pre-wrap">Hello, I believe I was bitten by a bug in my room (Room #____). Could you please send someone to inspect and disinfect the room immediately?</pre>
                            <button class="bg-green-600 text-white text-xs font-bold py-1 px-3 rounded-md mt-2 hover:bg-green-700" onclick="copyScript('script1')">ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬</button>
                            <h4 class="font-bold mt-4 mb-2">ë£¸ ë³€ê²½ ìš”ì²­</h4>
                            <pre id="script2" class="bg-slate-100 p-3 rounded-md text-sm whitespace-pre-wrap">I was bitten by a bug in my room and I have a photo of the bite. For my safety and hygiene, I would like to request a room change immediately. Could you please arrange a new room for me?</pre>
                            <button class="bg-green-600 text-white text-xs font-bold py-1 px-3 rounded-md mt-2 hover:bg-green-700" onclick="copyScript('script2')">ìŠ¤í¬ë¦½íŠ¸ ë³µì‚¬</button>
                        </div>
                    </div>
                    <div class="accordion-item border border-slate-200 rounded-lg">
                        <div class="accordion-header p-4 cursor-pointer font-semibold flex justify-between items-center" onclick="toggleAccordion(this)">
                            <span>ì•½êµ­/ë³‘ì› ë°©ë¬¸ ê°€ì´ë“œ</span><span class="transform transition-transform duration-300">â–¼</span>
                        </div>
                        <div class="accordion-content p-4 border-t border-slate-200 text-slate-600">
                             <p><b>- ì—°ê³ :</b> <span class="text-[#4154FF] font-mono">Hydrocortisone 1% cream</span></p>
                             <p><b>- ì•Œë ˆë¥´ê¸° ì•½:</b> <span class="text-[#4154FF] font-mono">Loratadine or Cetirizine</span></p>
                             <div class="mt-6 pt-4 border-t border-slate-200">
                                <h4 class="font-bold mb-2">ë‚´ ì£¼ë³€ ì˜ë£Œì‹œì„¤ ì°¾ê¸°</h4>
                                <div class="flex space-x-3">
                                    <a href="https://www.google.com/maps/search/?api=1&query=pharmacy+near+me" target="_blank" class="flex-1 text-center bg-teal-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-teal-600 no-underline">ì£¼ë³€ ì•½êµ­ ì°¾ê¸° ğŸ¥</a>
                                    <a href="https://www.google.com/maps/search/?api=1&query=hospital+near+me" target="_blank" class="flex-1 text-center bg-rose-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-rose-600 no-underline">ì£¼ë³€ ë³‘ì› ì°¾ê¸° ğŸš‘</a>
                                </div>
                             </div>
                        </div>
                    </div>
                </div>
                 <button class="w-full bg-slate-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-slate-600 mt-6" onclick="showStep(1)">ì²˜ìŒìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
            </div>
        </div>
    </div>

    <script>
        let currentStep = 1;
        const steps = document.querySelectorAll('.step');

        function showStep(stepNumber) {
            steps.forEach(step => step.classList.remove('active'));
            document.getElementById(`step${stepNumber}`).classList.add('active');
            currentStep = stepNumber;
        }

        const imageUpload = document.getElementById('imageUpload');
        const imagePreview = document.getElementById('imagePreview');
        const previewText = document.getElementById('previewText');
        const nextToSymptomsBtn = document.getElementById('nextToSymptomsBtn');

        imageUpload.addEventListener('change', function(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    imagePreview.src = e.target.result;
                    imagePreview.classList.remove('hidden');
                    previewText.classList.add('hidden');
                    nextToSymptomsBtn.classList.remove('hidden');
                }
                reader.readAsDataURL(file);
            }
        });

        function toggleSymptom(element) {
            element.classList.toggle('selected');
        }

        function startAnalysis() {
            showStep(4);
            const imageData = imagePreview.src;
            
            simulateApiCall(imageData).then(result => {
                generateResults(result);
            });
        }

        async function simulateApiCall(imageData) {
            console.log("Sending image data to AI API...", imageData.substring(0, 50) + "...");
            
            return new Promise(resolve => {
                setTimeout(() => {
                    const scenarios = [
                        { riskClass: 'bg-yellow-100 border-yellow-500 text-yellow-800', riskText: 'ì£¼ì˜: ì¦ìƒ ê´€ì°° ë° ëŒ€ì²˜ í•„ìš”', insect: 'ë¹ˆëŒ€ (Bed Bug)', summary: 'ì‹¬ê°í•œ ì§ˆë³‘ì„ ì˜®ê¸°ì§„ ì•Šì§€ë§Œ, ì‹¬í•œ ê°€ë ¤ì›€ì¦ê³¼ ì•Œë ˆë¥´ê¸° ë°˜ì‘ì„ ìœ ë°œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ í”¼í•´ ë°©ì§€ë¥¼ ìœ„í•´ í˜¸í…” ì¸¡ì— ì¦‰ì‹œ ì•Œë¦¬ê³  ë£¸ ë³€ê²½ì„ ìš”ì²­í•˜ì„¸ìš”.'},
                        { riskClass: 'bg-red-100 border-red-500 text-red-800', riskText: 'ìœ„í—˜: ê°€ê¹Œìš´ ë³‘ì› ë°©ë¬¸ ê¶Œì¥', insect: 'ë…ì„±ì´ ì˜ì‹¬ë˜ëŠ” ê±°ë¯¸', summary: 'ìƒì²˜ ë¶€ìœ„ì˜ í†µì¦ì´ ì‹¬í•˜ê³  ë¶“ê¸°ê°€ ë¹ ë¥´ê²Œ í¼ì§€ê³  ìˆìŠµë‹ˆë‹¤. ì •í™•í•œ ì§„ë‹¨ê³¼ ì¹˜ë£Œë¥¼ ìœ„í•´ ì¦‰ì‹œ ê°€ê¹Œìš´ ë³‘ì›ì„ ë°©ë¬¸í•˜ì„¸ìš”.'}
                    ];
                    const randomScenario = scenarios[Math.floor(Math.random() * scenarios.length)];
                    resolve(randomScenario);
                }, 2500);
            });
        }

        function generateResults(result) {
            const resultSummary = document.getElementById('result-summary');
            resultSummary.innerHTML = `
                <div class="result-card border-l-4 p-4 rounded-r-lg ${result.riskClass}">
                    <h3 class="font-bold mb-1">${result.riskText}</h3>
                    <p class="text-sm"><strong>AI ì¶”ì • ë²Œë ˆ: ${result.insect}</strong></p>
                </div>
                <p class="text-slate-600 mt-4">${result.summary}</p>
                <p class="text-xs text-slate-400 mt-4">â€» ì´ ë¶„ì„ì€ ì˜í•™ì  ì§„ë‹¨ì´ ì•„ë‹ˆë©°, ì‘ê¸‰ì²˜ì¹˜ ë° ëŒ€ì²˜ë¥¼ ë•ê¸° ìœ„í•œ AI ì¶”ì •ì¹˜ì…ë‹ˆë‹¤.</p>
            `;
            showStep(5);
        }

        function toggleAccordion(header) {
            header.classList.toggle('active');
            const icon = header.querySelector('span:last-child');
            icon.classList.toggle('rotate-180');
        }

        function copyScript(scriptId) {
            const textToCopy = document.getElementById(scriptId).innerText;
            const textArea = document.createElement('textarea');
            textArea.value = textToCopy;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                alert('ìŠ¤í¬ë¦½íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            } catch (err) { console.error('Fallback: Oops, unable to copy', err); }
            document.body.removeChild(textArea);
        }
        
        showStep(1);
    </script>
</body>
</html>
